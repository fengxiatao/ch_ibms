# 视频巡更任务界面改造 - SmartPSS Plus 风格

## 📸 界面对比

### 原有界面
- 分散式布局，功能分布在主页面各处
- 左侧面板：设备树和任务列表
- 中间区域：视频网格
- 独立的通道管理对话框

### 新界面（SmartPSS Plus 风格）
- 集中式对话框，一站式配置
- 专业的桌面应用风格
- 清晰的功能分区
- 直观的拖拽操作

## 🎯 改造重点

### 1. 布局结构

```
┌─────────────────────────────────────────────────────────────┐
│  任务编辑                                            [X]      │
├─────────────────────────────────────────────────────────────┤
│  任务名称: [任务 1]  ☑ 任务专属时间 [30] 秒  [确定] [取消]  │
├──────────┬──────────────────────────────┬───────────────────┤
│          │                              │                   │
│  设备树  │      2x2 视频预览网格        │   (可选操作区)    │
│          │                              │                   │
│  [组织]  │  ┌──────┬──────┐            │                   │
│  [NVR]   │  │ 格1  │ 格2  │            │                   │
│          │  ├──────┼──────┤            │                   │
│  搜索框  │  │ 格3  │ 格4  │            │                   │
│          │  └──────┴──────┘            │                   │
│  树形列表│                              │                   │
│          │   (深色背景 #2b2b2b)         │                   │
│          │                              │                   │
│  [场景]  │                              │                   │
│  [预案]  │                              │                   │
├──────────┴──────────────────────────────┴───────────────────┤
│  通道列表                                                    │
│  ┌────┬──────────┬──────┬────────┬──────┬──────┬────────┐  │
│  │序号│设备名称  │类型  │停留时间│绑定组│备注  │操作    │  │
│  ├────┼──────────┼──────┼────────┼──────┼──────┼────────┤  │
│  │ 1  │192.168...│ 无   │ [10]s  │组1   │房出1 │👁️⬆️⬇️🗑️│  │
│  └────┴──────────┴──────┴────────┴──────┴──────┴────────┘  │
└─────────────────────────────────────────────────────────────┘
```

### 2. 功能分区

#### 🔝 顶部配置区
- **位置**：对话框顶部
- **背景**：白色 (#fff)
- **内容**：
  - 任务名称输入框
  - 任务专属时间复选框
  - 时长数字输入框
  - 确定/取消按钮
- **高度**：自适应（约 60px）

#### 👈 左侧设备树
- **位置**：对话框左侧
- **宽度**：280px
- **背景**：白色 (#fff)
- **内容**：
  - 视图切换下拉框（组织/NVR）
  - 搜索输入框
  - 树形列表（懒加载）
  - 底部折叠面板（场景/预案）
- **特点**：
  - 支持拖拽设备节点
  - 显示在线状态
  - 刷新按钮

#### 🎬 中间视频区
- **位置**：对话框中央
- **背景**：深色 (#2b2b2b)
- **内容**：
  - 2x2 网格布局
  - 每个格子显示通道数量
  - 支持拖放添加
- **特点**：
  - 深色主题，专业感强
  - 虚线边框提示可拖放
  - 已添加通道显示实线边框

#### 📋 底部通道列表
- **位置**：对话框底部
- **高度**：200px
- **背景**：白色 (#fff)
- **内容**：
  - 表格展示所有通道
  - 可编辑字段（时长、备注）
  - 操作按钮（预览、排序、删除）
- **特点**：
  - 清晰的表格布局
  - 直观的操作按钮
  - 支持清空所有

## 🆚 功能对比表

| 功能项 | 原有方式 | SmartPSS 风格 | 改进点 |
|--------|----------|---------------|--------|
| **界面风格** | Web 风格 | 桌面应用风格 | ✅ 更专业 |
| **操作流程** | 多步骤切换 | 一站式配置 | ✅ 更高效 |
| **设备选择** | 左侧面板 | 对话框内树形 | ✅ 更集中 |
| **视频预览** | 主页面网格 | 对话框网格 | ✅ 更清晰 |
| **通道管理** | 独立对话框 | 底部表格 | ✅ 更直观 |
| **拖拽操作** | 支持 | 支持 | ✅ 保持一致 |
| **配置保存** | 多次保存 | 一次确认 | ✅ 更简洁 |
| **视觉对比** | 浅色为主 | 深浅对比 | ✅ 更专业 |

## 🎨 设计细节

### 颜色方案
```css
/* 主色调 */
--bg-light: #f5f5f5;        /* 浅色背景 */
--bg-dark: #2b2b2b;         /* 深色背景（视频区） */
--bg-darker: #1a1a1a;       /* 更深背景（视频格子） */
--bg-white: #fff;           /* 白色背景 */

/* 边框 */
--border-color: #e0e0e0;    /* 浅色边框 */
--border-dashed: #444;      /* 深色虚线边框 */
--border-active: #409eff;   /* 激活状态边框 */

/* 文字 */
--text-dark: #333;          /* 深色文字 */
--text-light: #666;         /* 浅色文字 */
--text-white: #fff;         /* 白色文字 */
```

### 间距规范
```css
/* 内边距 */
--padding-sm: 8px;
--padding-md: 12px;
--padding-lg: 16px;
--padding-xl: 20px;

/* 外边距 */
--margin-sm: 8px;
--margin-md: 12px;
--margin-lg: 16px;

/* 间隙 */
--gap-xs: 4px;
--gap-sm: 8px;
--gap-md: 12px;
```

## 📱 响应式设计

### 对话框尺寸
- **宽度**：90% 视口宽度
- **高度**：80vh
- **最小宽度**：建议 1200px
- **最小高度**：建议 800px

### 自适应布局
- 左侧树固定宽度 280px
- 中间视频区自适应
- 底部表格固定高度 200px

## 🚀 使用场景

### 适用场景 ✅
1. **新建任务**：从零开始配置巡检任务
2. **编辑任务**：修改现有任务配置
3. **快速配置**：拖拽快速添加通道
4. **批量管理**：统一管理多个通道

### 不适用场景 ❌
1. **实时监控**：建议使用主页面的实时视频网格
2. **快速查看**：建议使用任务列表的预览功能
3. **移动端**：对话框较大，不适合小屏幕

## 🔧 技术实现

### 核心技术栈
- **Vue 3**：Composition API
- **TypeScript**：类型安全
- **Element Plus**：UI 组件库
- **CSS Grid**：网格布局
- **Flexbox**：弹性布局

### 关键组件
```typescript
// 主组件
TaskEditDialog.vue

// 依赖组件
- el-dialog        // 对话框容器
- el-form          // 表单
- el-tree          // 树形控件
- el-table         // 表格
- el-input-number  // 数字输入
- el-collapse      // 折叠面板
```

### 数据流
```
用户操作 → 组件事件 → 数据更新 → 视图刷新
   ↓
拖拽设备 → handleDrop → 更新 videoCells/channelList → 表格更新
   ↓
编辑字段 → v-model → 双向绑定 → 实时更新
   ↓
保存任务 → handleSave → emit('save') → 父组件处理
```

## 📊 性能优化

### 已实现
- ✅ 懒加载树节点（按需加载通道）
- ✅ 虚拟滚动（表格大数据）
- ✅ 防抖搜索（输入延迟搜索）

### 待优化
- ⏳ 图片懒加载（截图）
- ⏳ 组件按需加载
- ⏳ 数据缓存策略

## 🎯 用户体验提升

### 操作便捷性
1. **拖拽添加**：直接拖拽设备到格子
2. **快捷编辑**：表格内直接编辑
3. **批量操作**：清空、删除等
4. **实时反馈**：操作即时生效

### 视觉引导
1. **颜色对比**：深浅分明，功能区分清晰
2. **图标提示**：拖拽图标、状态图标
3. **状态反馈**：边框变化、消息提示
4. **空状态**：友好的空状态提示

### 错误处理
1. **输入验证**：必填项检查
2. **操作确认**：删除前确认
3. **错误提示**：清晰的错误信息
4. **回退机制**：取消操作

## 📝 后续优化建议

### 功能增强
1. **多布局支持**：1x1, 3x3, 4x4 等
2. **预设模板**：常用配置模板
3. **批量导入**：Excel 导入通道
4. **配置导出**：导出为配置文件

### 交互优化
1. **键盘快捷键**：提高操作效率
2. **右键菜单**：更多快捷操作
3. **拖拽排序**：表格行拖拽排序
4. **撤销重做**：操作历史记录

### 视觉优化
1. **动画效果**：过渡动画
2. **加载状态**：骨架屏
3. **主题切换**：亮色/暗色主题
4. **自定义配色**：用户自定义

## 🎉 总结

通过模仿大华 SmartPSS Plus 的界面设计，我们成功打造了一个：

- ✅ **专业化**的任务编辑界面
- ✅ **集中式**的配置流程
- ✅ **直观化**的操作体验
- ✅ **现代化**的视觉设计

这个新界面不仅提升了用户体验，也为后续功能扩展提供了良好的基础。

---

**文档版本**：v1.0  
**更新时间**：2025-11-19  
**维护者**：开发团队
